apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: events-collector
spec:
  concurrencyPolicy: Forbid
  schedule: "0 */6 * * *"
  jobTemplate:
    spec:
      template:
        spec:
          restartPolicy: Never
          containers:
            - name: events-collector
              image: fintlabs.azurecr.io/events-collector:build.7
              envFrom:
                - configMapRef:
                    name: fint-environment
                - secretRef:
                    name: fint-events-collector
              env:
                - {name: JAVA_TOOL_OPTIONS, value: -XX:+ExitOnOutOfMemoryError -Xmx3G -verbose:gc}
                - {name: fint.audit.baseurl, value: https://api.felleskomponent.no/events}
                - {name: fint.audit.blob.container-name, value: fint-events-api}
                - {name: fint.audit.orgids, value: 'viken.no'}
                - {name: fint.audit.timeout, value: PT5M}
                - {name: fint.audit.collect, value: PT6H30M}
                - {name: fint.audit.retain, value: PT7H}
